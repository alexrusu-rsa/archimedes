<div class="container invoice-preview-download mx-0 d-flex">
  <mat-dialog-content class="align-self-center">
    <div class="d-flex justify-content-between col-12">
      <div class="col-8 mx-0 px-0">
        <mat-card-title
          class="col-12 text-start align-items-center mx-0 px-0 mb-0 pb-0 py-3"
          >{{ "invoice.dialogPreview" | translate }}</mat-card-title
        >
      </div>
      <div class="col-4 d-flex justify-content-end mx-0 px-0 pt-1">
        <button mat-icon-button class="col-12" mat-dialog-close>
          <mat-icon>close</mat-icon>
        </button>
      </div>
    </div>
    <mat-stepper linear #stepper class="stepper" color="accent">
      <mat-step [editable]="true">
        <div class="form-container">
          <form
            class="container mt-2 mx-0 px-0 col-12 pb-5"
            [formGroup]="invoiceForm!"
          >
            <ng-template matStepLabel>{{
              "invoice.dialog.firstStep" | translate
            }}</ng-template>
            <div class="row col-12 mx-0 px-0">
              <mat-form-field class="mx-0 px-0" appearance="fill">
                <mat-label>{{
                  "invoice.dialog.invoiceNumber" | translate
                }}</mat-label>
                <input
                  matInput
                  formControlName="invoiceNumber"
                  type="text"
                  placeholder="Example: 1234"
                />
                <mat-hint
                  *ngIf="
                    !invoiceNumber?.valid &&
                    (invoiceNumber?.touched || invoiceNumber?.dirty)
                  "
                  >{{
                    "invoice.dialog.invoiceNumberHint" | translate
                  }}</mat-hint
                >
              </mat-form-field>
            </div>

            <div class="row col-12 mx-0 px-0" *ngIf="romanianCustomer">
              <mat-form-field class="mx-0 px-0" appearance="fill">
                <mat-label>{{
                  "invoice.dialog.euroExchange" | translate
                }}</mat-label>
                <input
                  matInput
                  placeholder="Example: 4.97, 4.9283"
                  formControlName="euroExchange"
                  type="text"
                />

                <mat-hint
                  *ngIf="
                    !euroExchange?.valid &&
                    (euroExchange?.touched || euroExchange?.dirty)
                  "
                  >{{ "invoice.dialog.euroExchangeHint" | translate }}</mat-hint
                >
              </mat-form-field>
            </div>
            <div class="row col-12 mx-0 px-0">
              <mat-form-field class="mx-0 px-0" appearance="fill">
                <mat-label>{{
                  "invoice.dialog.invoiceEmittingDay" | translate
                }}</mat-label>
                <input
                  matInput
                  [matDatepicker]="datePicker"
                  (dateInput)="OnDateChange($event.value)"
                  formControlName="invoiceEmitDate"
                  ngDefaultControl
                />
                <mat-datepicker-toggle
                  [for]="datePicker"
                  matSuffix
                ></mat-datepicker-toggle>
                <mat-datepicker #datePicker touchUi></mat-datepicker>
              </mat-form-field>
            </div>
            <div class="row col-12 mx-0 px-0"></div>
          </form>
        </div>

        <div class="d-flex col-12 justify-content-end">
          <button
            mat-raised-button
            color="accent"
            matStepperNext
            (click)="downloadPDF()"
          >
            Next
          </button>
        </div></mat-step
      >
      <mat-step [editable]="isEditable">
        <ng-template matStepLabel>{{
          "invoice.dialog.secondStep" | translate
        }}</ng-template>
        <div class="d-flex col-12 mt-3 iframe-container">
          <ng-container *ngIf="pdfUrl" class="pdf-viewer col-12">
            <iframe
              class="viewer-content"
              [src]="pdfUrl | safe"
              frameborder="0"
            ></iframe
          ></ng-container>
        </div>
        <div class="d-flex col-12 justify-content-between">
          <button mat-raised-button color="accent" matStepperPrevious>
            Back
          </button>
          <button mat-raised-button color="accent" matStepperNext>Next</button>
        </div>
      </mat-step>

      <mat-step color="accent">
        <ng-template matStepLabel>{{
          "invoice.dialog.thirdStep" | translate
        }}</ng-template>
        <div
          class="download-container d-flex col-12 justify-content-center flex-column"
        >
          <mat-card-title class="download-title align-self-center">
            {{ "invoice.dialogPreview" | translate }} {{ invoiceTitle }}
          </mat-card-title>
          <div class="d-flex justify-content-center mt-4">
            <button
              mat-raised-button
              color="accent"
              (click)="downloadInvoice()"
            >
              <mat-card-title class="align-self-center"
                >Download</mat-card-title
              >
              <mat-icon class="donwload-button">download</mat-icon>
            </button>
          </div>

          <!-- <button
            mat-icon-button
            color="accent"
            class="align-self-center download-button ms-2"
            (click)="downloadInvoice()"
          >
            <mat-icon>download</mat-icon>
          </button> -->
        </div>
        <div class="d-flex col-12 justify-content-between">
          <button mat-raised-button color="accent" matStepperPrevious>
            Back
          </button>
        </div>
      </mat-step>
    </mat-stepper>
  </mat-dialog-content>
</div>
