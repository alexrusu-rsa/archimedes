<div class="container mt-4 mx-0 px-0">
  <div class="row text-start mb-3">
    <mat-card-title> {{ user?.name }} {{ user?.surname }} </mat-card-title>
  </div>
</div>

<div class="container mx-0 px-0">
  <div class="row col-12 mx-0 px-0 mb-2">
    <div class="col col-12 col-md-9 ml-0 mx-0 px-0 mt-2 p-0">
      <mat-form-field appearance="fill" class="col-12 no-padding-form-field">
        <input
          matInput
          [matDatepicker]="datePicker"
          [(ngModel)]="selectedDate"
          (dateChange)="dateChanges()"
        />
        <mat-datepicker-toggle
          [for]="datePicker"
          matSuffix
        ></mat-datepicker-toggle>
        <mat-datepicker #datePicker touchUi></mat-datepicker>
      </mat-form-field>
    </div>

    <div
      class="col-12 mt-4 col-md-3 my-md-0 mx-0 px-0 py-0 justify-content-end d-flex"
    >
      <mat-card
        class="col-12 col-md-6"
        [ngStyle]="{ 'background-color': timeBookedContainerColor }"
      >
        <mat-card-title class="d-md-none">Time booked:</mat-card-title>
        <h6>{{ totalTimeBooked }}/{{ currentEmployeeCommitment }}</h6>
      </mat-card>
    </div>
  </div>

  <div class="container mx-0 px-0">
    <div class="row col-12 mx-0 px-0 mb-2">
      <div class="col col-12 col-md-9 mx-0 px-0 mt-3">
        <mat-form-field appearance="fill" class="col-12 no-padding-form-field">
          <mat-label>Filter</mat-label>
          <mat-select
            (selectionChange)="setValueOfSelectedProject($event)"
            [(ngModel)]="selectedFilterProjectId"
          >
            <mat-option [value]="'all'"> All projects </mat-option>
            <mat-option
              *ngFor="let project of allProjects"
              [value]="project.id"
              required="true"
              ngDefaultControl
            >
              {{ project.projectName }}
            </mat-option>
          </mat-select></mat-form-field
        >
      </div>

      <div class="col-12 col-md-3 my-md-0 mx-0 px-0 justify-content-end d-flex">
        <button
          class="col-12 col-md-6 m-0 md-mt-0 px-0"
          mat-raised-button
          (click)="addNewActivity()"
        >
          <mat-icon color="accent">add_box</mat-icon>
        </button>
      </div>
    </div>
  </div>
</div>
<div class="container mx-0 px-0">
  <mat-card class="content-container" *ngIf="activitiesOfTheDay.length < 1">
    <mat-card class="entity-card">
      <mat-card-title
        >You have not reported any activities for this day yet.</mat-card-title
      >
    </mat-card>
  </mat-card>
</div>
<div class="container mx-0 px-0 mb-2">
  <mat-card
    class="container content-container mb-2"
    *ngFor="let project of projectsOfCurrentDayAndActivities"
  >
    <div class="row col-12 text-start mt-2 mx-0 px-0 mb-4">
      <mat-card-title class="col-12 mx-0 px-0">{{
        project.projectId | projectid: allProjects!
      }}</mat-card-title>
    </div>
    <div class="row mx-0 px-0">
      <mat-card
        class="entity-card mx-0 mb-2"
        *ngFor="let activity of project.activitiesWithProjectId"
      >
        <mat-card-title>{{ activity.name }}</mat-card-title>
        <mat-card-subtitle>
          {{ activity.start }} - {{ activity.end }}</mat-card-subtitle
        >
        <mat-card-content>
          {{ activity.description }}
          <mat-chip-list
            *ngIf="activity.projectId !== null && activity.projectId !== ''"
          >
            <div>
              <mat-chip
                >{{
                  activity.projectId!
                    | customerfromprojectid: allProjects!:allCustomers!
                }}
                {{ activity.projectId! | projectid: allProjects! }}</mat-chip
              >
            </div>
          </mat-chip-list>
          <mat-chip-list
            *ngIf="
              activity.projectId === undefined || activity.projectId === null
            "
          >
            <mat-chip> Internal </mat-chip>
          </mat-chip-list>
        </mat-card-content>

        <mat-card-actions
          class="row mx-0 mt-0 mb-0 pt-0 pb-0 px-0 col-12 justify-content-end d-flex"
        >
          <button
            mat-button
            class="col-2 col-lg-1 mx-0 px-0"
            color="accent"
            (click)="editActivity(activity)"
          >
            <mat-icon>edit</mat-icon>
          </button>

          <button
            mat-button
            color="accent"
            class="col-2 col-lg-1 mx-0 px-0"
            (click)="duplicateActivity(activity)"
          >
            <mat-icon>control_point_duplicate</mat-icon>
          </button>
          <button
            mat-raised-button
            class="col-2 col-lg-1 mx-0 px-0"
            color="accent"
            (click)="deleteActivity(activity)"
          >
            <mat-icon>delete</mat-icon>
          </button>
        </mat-card-actions>
      </mat-card>
    </div>
    <div class="row col-12 mx-0 px-0">
      <button
        class="entity-card col-12"
        mat-raised-button
        (click)="addActivityOnCertainProject(project.projectId)"
      >
        <mat-icon color="accent">add_box</mat-icon>
      </button>
    </div>
  </mat-card>
</div>
<div class="container mx-0 px-0">
  <mat-card *ngIf="activitiesWithNoProject?.length !== 0">
    <div class="row col-12 text-start mx-0 px-0"></div>
    <mat-card-title class="col-12 mx-0 px-0 mb-3 mt-2"> Other </mat-card-title>
    <mat-card
      class="entity-card mb-2"
      *ngFor="let activity of activitiesWithNoProject"
    >
      <mat-card-title>{{ activity.name }}</mat-card-title>
      <mat-card-subtitle>
        {{ activity.start }} - {{ activity.end }}</mat-card-subtitle
      >

      <mat-card-actions
        class="row mx-0 mt-0 mb-0 pt-0 pb-0 px-0 col-12 justify-content-end d-flex"
      >
        <button
          mat-button
          class="col-2 col-lg-1 mx-0 px-0"
          color="accent"
          (click)="editActivity(activity)"
        >
          <mat-icon>edit</mat-icon>
        </button>

        <button
          mat-button
          color="accent"
          class="col-2 col-lg-1 mx-0 px-0"
          (click)="duplicateActivity(activity)"
        >
          <mat-icon>control_point_duplicate</mat-icon>
        </button>
        <button
          mat-raised-button
          class="col-2 col-lg-1 mx-0 px-0"
          color="accent"
          (click)="deleteActivity(activity)"
        >
          <mat-icon>delete</mat-icon>
        </button>
      </mat-card-actions>
    </mat-card>
    <div class="row col-12 mx-0 px-0">
      <button
        class="entity-card col-12"
        mat-raised-button
        (click)="addNewActivity()"
      >
        <mat-icon color="accent">add_box</mat-icon>
      </button>
    </div>
  </mat-card>
</div>
