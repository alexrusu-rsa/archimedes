<div class="dialog-container">
  <mat-dialog-content *ngIf="currentRate && rate === null">
    <mat-card-title>Add Rate</mat-card-title>
    <form [formGroup]="addRateForm!" (keyup.enter)="addRate()">
      <mat-form-field appearance="fill">
        <mat-label>Project</mat-label>
        <input
          type="text"
          aria-label="Project"
          matInput
          [(ngModel)]="currentRate.projectId"
          [matAutocomplete]="auto"
        />
        <mat-autocomplete
          autoActiveFirstOption
          #auto="matAutocomplete"
          [(ngModel)]="currentRate.projectId"
          (optionSelected)="onSelectionChange($event)"
        >
          <mat-option value="null">No project</mat-option>
          <mat-option
            *ngFor="let project of filteredProjects | async"
            [value]="project.projectName"
            ngDefaultControl
            >{{ project.projectName }}</mat-option
          >
        </mat-autocomplete>
      </mat-form-field>

      <mat-form-field appearance="fill">
        <mat-label>Employee</mat-label>
        <input
          matInput
          [(ngModel)]="currentRate.employeeId"
          type="text"
          formControlName="employeeId"
          required="true"
        />
      </mat-form-field>
      <mat-form-field appearance="fill">
        <mat-label>Rate</mat-label>
        <input
          matInput
          [(ngModel)]="currentRate.rate"
          type="text"
          formControlName="employeeRate"
          required="true"
        />
      </mat-form-field>
      <mat-form-field appearance="fill">
        <mat-label>Rate Type</mat-label>
        <input
          matInput
          [(ngModel)]="currentRate.rateType"
          type="text"
          formControlName="employeeRateType"
          required="true"
        />
      </mat-form-field>
      <mat-form-field appearance="fill">
        <mat-label>Employee Time Commitement</mat-label>
        <input
          matInput
          [(ngModel)]="currentRate.employeeTimeCommitement"
          type="text"
          formControlName="employeeTimeCommitement"
          required="true"
        />
      </mat-form-field>
    </form>
    <button
      *ngIf="rate === null"
      mat-raised-button
      color="accent"
      (click)="addRate()"
    >
      Add rate
    </button>
  </mat-dialog-content>
  <mat-dialog-content *ngIf="currentRate && rate !== null">
    <mat-card-title>Update Rate</mat-card-title>
    <form [formGroup]="addRateForm!" (keyup.enter)="editRate()">
      <mat-form-field appearance="fill">
        <mat-label i18n="@@activity-dialog-activityProject">Project</mat-label>
        <input
          type="text"
          aria-label="Project"
          matInput
          [value]="findProjectNameWithId(currentRate.projectId!)"
          formControlName="projectName"
          [matAutocomplete]="auto"
        />
        <mat-autocomplete
          autoActiveFirstOption
          #auto="matAutocomplete"
          [(ngModel)]="currentRate.projectId"
          (optionSelected)="onSelectionChange($event)"
        >
          <mat-option value="null">No project</mat-option>
          <mat-option
            *ngFor="let project of filteredProjects | async"
            [value]="project.projectName"
            ngDefaultControl
            >{{ project.projectName }}</mat-option
          >
        </mat-autocomplete>
      </mat-form-field>

      <mat-form-field appearance="fill">
        <mat-label>Employee</mat-label>
        <input
          matInput
          [(ngModel)]="currentRate.employeeId"
          type="text"
          formControlName="employeeId"
          required="true"
        />
      </mat-form-field>
      <mat-form-field appearance="fill">
        <mat-label>Rate</mat-label>
        <input
          matInput
          [(ngModel)]="currentRate.rate"
          type="text"
          formControlName="employeeRate"
          required="true"
        />
      </mat-form-field>
      <mat-form-field appearance="fill">
        <mat-label>Rate Type</mat-label>
        <input
          matInput
          [(ngModel)]="currentRate.rateType"
          type="text"
          formControlName="employeeRateType"
          required="true"
        />
      </mat-form-field>
      <mat-form-field appearance="fill">
        <mat-label>Employee Time Commitement</mat-label>
        <input
          matInput
          [(ngModel)]="currentRate.employeeTimeCommitement"
          type="text"
          formControlName="employeeTimeCommitement"
          required="true"
        />
      </mat-form-field>
    </form>
    <button
      *ngIf="rate !== null"
      mat-raised-button
      color="accent"
      (click)="editRate()"
    >
      Update rate
    </button>
  </mat-dialog-content>
</div>
